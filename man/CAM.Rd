% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CAM.R
\name{CAM}
\alias{CAM}
\title{Causal Additive Model}
\usage{
CAM(
  X,
  nodeModelName = c("gam", "lasso", "poly", "linear", "lmboost"),
  scoreFunction = logLik,
  nodeModelPars = NULL,
  maxNumParents = min(ncol(X) - 1, floor((nrow(X) - 1)/9)),
  fixedOrders = matrix(ncol = 2, nrow = 0),
  orderFixationMethod = c("emulate_edge", "force_edge", "free"),
  variableSel = FALSE,
  pnsMethod = NULL,
  pnsModelPars = NULL,
  pnsSelectionPars = NULL,
  pruning = FALSE,
  pruneMethod = NULL,
  pruneModelPars = NULL,
  pruneSelectionPars = NULL,
  earlyStop = Inf,
  intervData = FALSE,
  intervMat = NULL,
  numCores = 1,
  verbose = FALSE
)
}
\arguments{
\item{X}{nxp matrix of training inputs (n data points, p dimensions)}

\item{maxNumParents}{specifies the maximal number of parents that are
allowed in the model.}

\item{variableSel}{specifies whether initial variable selection (Step 1 of
CAM algorithm) shall be performed (TRUE) or not (FALSE). Initial variable
selection reduces the number of possible parents for a given node and
therefore enables computing the causal structure for large p.}

\item{pruning}{specifies whether pruning (Step 3 of CAM algorithm) shall be
performed (TRUE) or not (FALSE). Pruning reduces the number of edges in the
estimated causal structure.}

\item{pruneMethod}{specifies the method used for the pruning step. Default
is selGAM which is based on the gam() function from the mgcv package.}

\item{intervData}{boolean that indicates whether we use interventional data.}

\item{intervMat}{the matrix intervMat has the same dimension as X. entry
(i,j) == TRUE indicates that in experiment i, variable j has been intervened
on.}

\item{numCores}{specifies the number of cores that can be used for
computation.}

\item{verbose}{shall verbose be printed to the console (TRUE/FALSE)}

\item{scoreName}{specifies the model type which is used to compute the
score. Default is "SEMGAM" which assumes a generalized additive model class.
Other options include "SEMLIN" which fits a linear model.}

\item{parsScore}{additional parameters can be supported to the score
function.}

\item{variableSelMethod}{specifies the method that is used for variable
selection. Default is selGamBoost which uses the gamboost function from
mboost package. Other options include: selGam (gam() from mgcv), selLm based
on linear regression, selLasso based on Lasso regression from package
glmnet.}

\item{variableSelMethodPars}{optional parameters to modify settings of the
selection method.}

\item{pruneMethodPars}{optional parameters to tune the pruning step.}
}
\value{
list of attributes of the final estimated causal structure
\item{Adj}{adjacency matrix of estimated causal graph} \item{Score}{Total
edge score of estimated graph} \item{timesVec}{Vector containing various
time measurements for execution times of the individual steps of the CAM
algorithm}
}
\description{
fits a causal additive model using the CAM algorithm, see references below
}
\details{
The code fits a CAM model. See the references below for more details.
Identifiability results for the model class can be found in

J. Peters, J. Mooij, D. Janzing, B. Sch\"olkopf: Causal Discovery with
Continuous Additive Noise Models, JMLR 15:2009-2053, 2014.
}
\examples{

n <- 500
eps1<-rnorm(n)
eps2<-rnorm(n)
eps3<-rnorm(n)
eps4<-rnorm(n)

x2 <- 0.5*eps2
x1 <- 0.9*sign(x2)*(abs(x2)^(0.5))+0.5*eps1
x3 <- 0.8*x2^2+0.5*eps3
x4 <- -0.9*sin(x3) - abs(x1) + 0.5*eps4

X <- cbind(x1,x2,x3,x4)

trueDAG <- cbind(c(0,1,0,0),c(0,0,0,0),c(0,1,0,0),c(1,0,1,0))
## x4 <- x3 <- x2 -> x1 -> x4
## adjacency matrix:
## 0 0 0 1
## 1 0 1 0
## 0 0 0 1
## 0 0 0 0

estDAG <- CAM(X, pruning = TRUE)

cat("true DAG:\n")
show(trueDAG)

cat("estimated DAG:\n")
show(estDAG$Adj)

}
\references{
P. B\"uhlmann, J. Peters, J. Ernest: CAM: Causal Additive
Models, high-dimensional Order Search and Penalized Regression Annals of
Statistics 42:2526-2556, 2014.
}
\author{
Jonas Peters <jonas.peters@tuebingen.mpg.de> and Jan Ernest
<ernest@stat.math.ethz.ch>
}
\keyword{Additive}
\keyword{Causality}
\keyword{Equation}
\keyword{Model}
\keyword{Models}
\keyword{Noise}
\keyword{Regression}
\keyword{Restricted}
\keyword{Structural}
